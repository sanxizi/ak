# 高性能MYSQL



## 第一章：架构与历史

### 1.1 MySQL服务器逻辑架构

第一层：连接/线程处理：非MySQL独有

第二层：解析器 查询缓存：核心服务功能都在这一层。所有跨存储引擎的功能都在这一层实现：存储过程，触发器，视图等。

第三层：包含了存储引擎，存储引擎包含了MySQL中的数据的存储与提取。

> 注：存储引擎不会解析sql，InnoDB是个例外，会解析外键定义，但是MySQL服务器本身没有实现该功能。



**优化与执行：**

对于select语句，解析查询前服务器会先检查查询缓存（Query Cache）,若能找到对应的查询，服务器就不必再执行查询解析，优化和执行的过程。

### 1.2 并发控制

**读写锁：**

共享锁/也称读锁：读锁是共享的，相互不阻塞，多个用户可以在同一时刻读多取同一个资源而互不干扰。

排他锁/也称写锁：写锁是排他的，即一个写锁会阻塞其他的写锁和读锁，确保在给定时间内，只有一个用户能执行写入，并防止其他用户读取正在写入的同一资源。

**锁粒度：**

一种提高共享资源并发性的方式就是让锁定对象更有选择性。（尽量只锁定需要修改的部分）

任何时候给定的资源上锁定的数据量越少，系统的并发程度越高，只要相互之间不发生冲突就好。